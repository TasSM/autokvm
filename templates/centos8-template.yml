#cloud-config
 
# Hostname management
preserve_hostname: False
hostname: {{HOSTNAME}}
 
# Users
users:
  - default
  - name: {{USER}}
    groups: ['wheel']
    shell: /bin/bash
    sudo: ALL=(ALL) NOPASSWD:ALL
    ssh_authorized_keys:
      - {{PUBKEY}}
      
output:
  all: ">> /var/log/cloud-init.log"
ssh_genkeytypes: ['ed25519', 'rsa']
ssh_authorized_keys:
  - {{PUBKEY}}
  
timezone: {{LOCALE}}
runcmd:
  - systemctl stop NetworkManager.service && systemctl start NetworkManager.service
  - nmcli connection mod eth0 ipv4.gateway {{GATEWAY}}
  - nmcli connection mod eth0 ipv4.addresses {{IP_ADDRESS}}/{{PREFIX}}
  - nmcli connection mod eth0 ipv4.dns {{DNS}}
  - nmcli connection mod eth0 ipv4.method manual
  - nmcli connection reload eth0
  - dnf -y remove cloud-init